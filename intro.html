<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com"> 
    <link rel="stylesheet" href="css/fonts/nafta/nafta.css">
    <link rel="stylesheet" href="css/fonts/fucktura/fucktura.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/new-style.css">
    <title>matthieu abily</title>
    <meta name="description" content="matthieu abily cinematography" />

    <script>
        function rand(min, max, floored = false) {
            var v = Math.random() * (max - min + 1) + min;
            if (floored) v = Math.floor(v);
            return v;
        }

        function prepareTextForGlitch(div) {
            var text = div.textContent;
            var splitText = text.split('');
            div.textContent = '';
            for (var j = 0; j < splitText.length; j++) {
                if (splitText[j] === ' ') {
                    div.innerHTML += ' ';
                } else {
                    div.innerHTML += '<span>' + splitText[j] + '</span>';
                }
            }
            var spans = div.getElementsByTagName('span');
            return spans;
        }

        function glitchCharacter(span, iterations) {
            if (iterations < 0) {
                span.style.transform = 'translate(0, 0)';
                span.style.color = '';
                span.style.fontFamily = '';
                span.style.textShadow = '';
                return;
            }

            span.style.transform = `translate(${rand(-20, 20, true)}px, ${rand(-20, 20, true)}px)`;
            // span.style.color = `rgb(${rand(0, 255)}, ${rand(0, 255)}, ${rand(0, 255)})`;
            span.style.fontFamily = `'Courier New', Courier, monospace`;
            span.style.textShadow = `${rand(-2, 2)}px ${rand(-2, 2)}px 2px rgba(${rand(0, 255)}, ${rand(0, 255)}, ${rand(0, 255)}, 0.5)`;

            setTimeout(function() {
                glitchCharacter(span, iterations - 1)
            }, 50);
        }

        function glitchText(spans) {
            for (var i = 0; i < rand(1, 3, true); i++) {
                var spanIndex = rand(0,  spans.length - 1, true);
                setTimeout(glitchCharacter, rand(0, 500), spans[spanIndex], rand(0, 3, true));
            }
        }

        function glitchTextClock(spans) {
            setInterval(function() {
                glitchText(spans);
            }, rand(1500, 3000));
        }

        // glitch effect
        function glitch() {
            var glitch = document.getElementsByClassName('glitched-text-clock');
            for (var i = 0; i < glitch.length; i++) {
                spans = prepareTextForGlitch(glitch[i]);
                glitchTextClock(spans);
            }

            var glitchOver = document.getElementsByClassName('glitched-text-over');
            for (var i = 0; i < glitchOver.length; i++) {
                spans = prepareTextForGlitch(glitchOver[i]);
                glitchOver[i].addEventListener("mouseover", (function(local_spans) {
                    return function() {
                        glitchText(local_spans);
                    }
                })(spans));
            }
        }

        window.onload = function() {
            glitch();
        }
    </script>

</head>
<body>
    <div id="background"><div id="grain"></div></div>

    <div id="title">
        <div class="glitched-text noise-text">matthieu abily</div>
        <div id="subtitle" class="glitched-text">dop</div>
    </div>

    <div id="menu">
        <div class="item glitched-text glitched-text-over">
            <a href="#">showreel</a>
        </div>
        <div class="item glitched-text glitched-text-over">
            <a href="#">contact</a>
        </div>
    </div>

    <div id="content">
        <a href="#"><img src="images/empty-sprites-black-big.png" alt="instagram" class="intro-element"></a>
    </div>
</body>
</html>
